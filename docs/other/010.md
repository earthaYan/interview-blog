# 前端性能优化(3)

## 图片加载优化

从三个角度进行优化

1. 资源选择：
   - 格式选择：在上传资源的时候，优先采用 avif 和 webp 这种较新的格式，结合 picture 标签自上而下检查实现优雅回退；
   - 内容选择：对于 logo/图标类这种优先使用 svg 格式，不失真且体积较小，可以通过 css 修改图片

::: tip
webP 格式：在图片压缩率和兼容性之间达到了平衡，体积只有普通图片资源的 25%~35%

avif 格式：体积更小，但兼容性较差，不兼容 chrome 85 以下的浏览器
:::

2. 加载策略：核心思想是按需加载，避免浪费
   - 响应式图片：使用 image 标签的 srcset,size 属性为不同的设备提供不同尺寸的图片
   - 懒加载：延迟加载非视口内的图片，比如给非首屏展示的 image 添加 loading=lazy 属性，如果需要更精细控制，比如自定义占位符或者添加加载动画，可以使用 IntersectionObserver 监听对应元素是否进入视口范围
3. 分发链路：通过 CDN 提高分发效率，另外一些 CDN 服务商提供了图片处理服务，只需要上传一张原图，请求图片的时候在 url 上增加一个参数，CDN 就会实现动态裁剪、缩放、添加水印以及转换格式等功能，将这部分内容从前端业务代码上剥离

## 大量图标加载

解决方案：SVG 雪碧图
